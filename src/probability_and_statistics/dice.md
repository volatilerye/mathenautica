# サイコロの合計が $n$ の倍数になる確率

> [!NOTE] 問題
> どの目も出る確率が同様に確からしい $D$ 面サイコロを $n$ 個投げた.  
> このとき, 出た目の合計が $k$ の倍数である確率 $P\_{k,n,D}$ を求めよ.

この問題は **母関数 (生成関数)** を用いるととても巧妙に一般の確率を求めることができる.

---

生成関数 $f(z)$ を

$$f(z) = \left\\{\frac{1}{D}\sum\_{i=1}^{D}z^i\right\\}^n$$ と定義する.
すると, $f(z)$ の $x^m$ の係数 $c_m$ は, 出た目の合計が $k$ の倍数である確率と一致する.

ここで, $1$ の $k$ 乗根を $\xi\_k$ としよう (以降, 文脈から明らかな場合は単に $\xi$ と書く).

$$\xi\_k = e^{i2\pi/k} = \cos \frac{2\pi}{k} + i\sin \frac{2\pi}{k}.$$

求めたい確率は $P\_{k,n,D} = c\_k+c\_{2k}+c\_{3k}$ であるが, $k$ 乗根 $\xi$ を使うことで,
関係ない係数 $c_m$ は上手い事にすべて除去することができる.

$$
\begin{align}
P\_{k,n,D} 
&= \frac{1}{k}\left\\{\sum\_{m=1}^{k}f(\xi^m)\right\\}  \notag \\\\
&= \frac{1}{k}\left\\{1+D^{-n}\sum\_{m=1}^{k-1}\left(\sum\_{i=1}^{D}\xi^{im}\right)^n\right\\} \\\\
&= \frac{1}{k}\left\\{1+\xi^nD^{-n}\sum\_{m=1}^{k-1}(1-\xi^{Dm})^n(1-\xi^m)^{-n}\right\\}.
\end{align}
$$

> [!proof]
> 自明.

---

> [!default] draft
> 現在執筆中...