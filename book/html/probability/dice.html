<!DOCTYPE HTML>

<html class="light sidebar-visible" dir="ltr" lang="jp">
<head>
<!-- Book generated using mdBook -->
<meta charset="utf-8"/>
<title>サイコロの合計が $n$ の倍数になる確率 - MATH∃NAUTICA🌌</title>
<!-- Custom HTML head -->
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Jost:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet"/>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css" integrity="sha384-5TcZemv2l/9On385z///+d7MSYlvIEw9FuZTIdZ14vJLqWphw7e7ZPuOiCHJcFCP" rel="stylesheet"/>
<!-- The loading of KaTeX is deferred to speed up page rendering -->
<script crossorigin="anonymous" defer="" integrity="sha384-cMkvdD8LoxVzGF/RPUKAcvmm49FQ0oxwDF3BGKtDXcEc+T1b2N+teh/OJfpU0jr6" src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script>
<!-- To automatically render math in text elements, include the auto-render extension: -->
<script crossorigin="anonymous" defer="" integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh" onload="renderMathInElement(document.body);" src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script>
<script>
        document.addEventListener("DOMContentLoaded", function() {
          renderMathInElement(
              document.body,
              {
                  delimiters: [
                      {left: "$$", right: "$$", display: true},
                      {left: "$", right: "$", display: false},
                  ]
              });
          });
        </script>
<meta content="volatile rye's math notebook." name="description"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="#ffffff" name="theme-color"/>
<link href="../favicon.png" rel="shortcut icon"/>
<link href="../css/variables.css" rel="stylesheet"/>
<link href="../css/general.css" rel="stylesheet"/>
<link href="../css/chrome.css" rel="stylesheet"/>
<!-- Fonts -->
<link href="../FontAwesome/css/font-awesome.css" rel="stylesheet"/>
<link href="../fonts/fonts.css" rel="stylesheet"/>
<!-- Highlight.js Stylesheets -->
<link href="../highlight.css" id="highlight-css" rel="stylesheet"/>
<link href="../tomorrow-night.css" id="tomorrow-night-css" rel="stylesheet"/>
<link href="../ayu-highlight.css" id="ayu-highlight-css" rel="stylesheet"/>
<!-- Custom theme stylesheets -->
<!-- Provide site root and default themes to javascript -->
<script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
<!-- Start loading toc.js asap -->
<script src="../toc.js"></script>
</head>
<body>
<div id="mdbook-help-container">
<div id="mdbook-help-popup">
<h2 class="mdbook-help-title">Keyboard shortcuts</h2>
<div>
<p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
<p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the site</p>
<p>Press <kbd>?</kbd> to show this help</p>
<p>Press <kbd>Esc</kbd> to hide this help</p>
</div>
</div>
</div>
<div id="body-container">
<!-- Work around some values being stored in localStorage wrapped in quotes -->
<script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>
<!-- Set the theme before any content is loaded, prevents flash -->
<script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>
<input class="hidden" id="sidebar-toggle-anchor" type="checkbox"/>
<!-- Hide / unhide sidebar before it is displayed -->
<script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>
<nav aria-label="Table of contents" class="sidebar" id="sidebar">
<!-- populated by js -->
<mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
<noscript>
<iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
</noscript>
<div class="sidebar-resize-handle" id="sidebar-resize-handle">
<div class="sidebar-resize-indicator"></div>
</div>
</nav>
<div class="page-wrapper" id="page-wrapper">
<div class="page">
<div id="menu-bar-hover-placeholder"></div>
<div class="menu-bar sticky" id="menu-bar">
<div class="left-buttons">
<label aria-controls="sidebar" aria-label="Toggle Table of Contents" class="icon-button" for="sidebar-toggle-anchor" id="sidebar-toggle" title="Toggle Table of Contents">
<i class="fa fa-bars"></i>
</label>
<button aria-controls="theme-list" aria-expanded="false" aria-haspopup="true" aria-label="Change theme" class="icon-button" id="theme-toggle" title="Change theme" type="button">
<i class="fa fa-paint-brush"></i>
</button>
<ul aria-label="Themes" class="theme-popup" id="theme-list" role="menu">
<li role="none"><button class="theme" id="default_theme" role="menuitem">Auto</button></li>
<li role="none"><button class="theme" id="light" role="menuitem">Light</button></li>
<li role="none"><button class="theme" id="rust" role="menuitem">Rust</button></li>
<li role="none"><button class="theme" id="coal" role="menuitem">Coal</button></li>
<li role="none"><button class="theme" id="navy" role="menuitem">Navy</button></li>
<li role="none"><button class="theme" id="ayu" role="menuitem">Ayu</button></li>
</ul>
<button aria-controls="searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-label="Toggle Searchbar" class="icon-button" id="search-toggle" title="Search (`/`)" type="button">
<i class="fa fa-search"></i>
</button>
</div>
<h1 class="menu-title">MATH∃NAUTICA🌌</h1>
<div class="right-buttons">
<a aria-label="Git repository" href="https://github.com/volatilerye/mathenautica" title="Git repository">
<i class="fa fa-github" id="git-repository-button"></i>
</a>
</div>
</div>
<div class="hidden" id="search-wrapper">
<form class="searchbar-outer" id="searchbar-outer">
<input aria-controls="searchresults-outer" aria-describedby="searchresults-header" id="searchbar" name="searchbar" placeholder="Search this site ..." type="search"/>
</form>
<div class="searchresults-outer hidden" id="searchresults-outer">
<div class="searchresults-header" id="searchresults-header"></div>
<ul id="searchresults">
</ul>
</div>
</div>
<!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
<script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>
<div class="content" id="content">
<main><nav aria-label="Page navigation" class="prev-next-buttons">
<a aria-keyshortcuts="Left" class="local-button active" href="../analysis/sum_sin_cos.html" rel="prev" style="text-decoration: none;" title="$\sum_{k=0}^{n}\sin k\theta, \sum_{k=0}^{n}\cos k\theta$">
<span class="arrow">←</span>
<span class="where">$\sum_{k=0}^{n}\sin k\theta, \sum_{k=0}^{n}\cos k\theta$</span>
</a>
<a aria-keyshortcuts="Right" class="local-button active" href="../test.html" rel="next" style="text-decoration: none;" title="test">
<span class="where">test</span>
<span class="arrow">→</span>
</a>
</nav>
<h1 id="サイコロの合計が-n-の倍数になる確率"><a class="header" href="#サイコロの合計が-n-の倍数になる確率">サイコロの合計が $n$ の倍数になる確率</a></h1>
<div class="alert note"><p class="alert note title">問題</p>
どの目も出る確率が同様に確からしい $D$ 面サイコロを $n$ 個投げた.<br/>
このとき, 出た目の合計が $k$ の倍数である確率 $P_{n,k,D}$ を求めよ.
</div>
<p>この問題は <strong>母関数 (生成関数)</strong> を用いるととても巧妙に一般の確率を求めることができる.</p>
<hr/>
<h2 id="生成関数による解法"><a class="header" href="#生成関数による解法">生成関数による解法</a></h2>
<p>生成関数 $f(z)$ を</p>
<p>$$f(z) = \left\{\frac{1}{D}\sum_{j=1}^{D}z^i\right\}^n$$ と定義する.
すると, $f(z)$ の $x^m$ の係数 $c_m$ は, 出た目の合計が $k$ の倍数である確率と一致する.</p>
<p>ここで, $1$ の $k$ 乗根を $\xi_k$ としよう (以降, 文脈から明らかな場合は単に $\xi$ と書く).</p>
<p>$$\xi_k = e^{i2\pi/k} = \cos \frac{2\pi}{k} + i\sin \frac{2\pi}{k}.$$</p>
<p>求めたい確率は $P_{n,k,D} = c_k+c_{2k}+c_{3k}$ であるが, $k$ 乗根 $\xi$ を使うことで,
関係ない係数 $c_m$ は上手い事にすべて除去することができる.</p>
<p>$$
\begin{align}
P_{n,k,D}
&= \frac{1}{k}\left\{\sum_{m=1}^{k}f(\xi^m)\right\}  \notag \\
&= \frac{1}{k}\left\{1+D^{-n}\sum_{m=1}^{k-1}\left(\sum_{j=1}^{D}\xi^{jm}\right)^n\right\} \\
&= \frac{1}{k}\left\{1+D^{-n}\sum_{m=1}^{k-1}\left\{\xi^m(1-\xi^{Dm})(1-\xi^m)^{-1}\right\}^n\right\}.
\end{align}
$$</p>
<hr/>
<h2 id="特定の条件にある場合の確率"><a class="header" href="#特定の条件にある場合の確率">特定の条件にある場合の確率</a></h2>
<p>$k, D$ が特定の条件にある場合は, $P_{n,k,D}$ は簡単に求めることができる.</p>
<div class="alert important"><p class="alert important title">補題1</p>
$$
\begin{align}
\xi^{k} &= 1, \\
\xi^{1} + \xi^{2} + \dots + \xi^{k} &= 0. \\
\end{align}
$$
</div>
<div class="alert proof"><details><summary>証明 (クリックで展開)</summary>
<p class="alert proof title"></p>
式(3) は $k$ 乗根の定義より明らか.
<p>式(4) は
$$
\begin{align*}
&\xi^{k} = 1 \\
\Longrightarrow\;&
\xi^{k} -1 = 0 \\
\Longrightarrow\;&
(\xi -1)(1+\xi+\dots+\xi^{k-1}) = 0 \\
\Longrightarrow\;&
1+\xi+\dots+\xi^{k-1} = 0 \\
\Longrightarrow\;&
\xi+\xi^2+\dots+\xi^{k} = 0.
\end{align*}
$$</p>
<div style="position: relative;"><span style="position: absolute; right: 0em; bottom: 0em; font-size: 1.5em;">■</span></div>
</details>
</div>
<div class="alert tip"><p class="alert tip title">定理2</p>
$k$ が $D$ の約数ならば, $P_{n,k,D}=1/k.$
</div>
<div class="alert proof"><details><summary>証明 (クリックで展開)</summary>
<p class="alert proof title"></p>
式(2), (4)より,
$$
\begin{align*}
P_{n,k,D}
&= \frac{1}{k}\left\{1+D^{-n}\sum_{m=1}^{k-1}\left\{\xi^m(1-\xi^{Dm})(1-\xi^m)^{-1}\right\}^n\right\} \\
&= \frac{1}{k}\left\{1+D^{-n}\sum_{m=1}^{k-1}\left\{\xi^m\cdot 0 \cdot(1-\xi^m)^{-1}\right\}^n\right\} \\
&= \frac{1}{k}. \\
\end{align*}
$$
<div style="position: relative;"><span style="position: absolute; right: 0em; bottom: 0em; font-size: 1.5em;">■</span></div>
</details>
</div>
<div class="alert tip"><p class="alert tip title">定理3</p>
$k=D+1$ ならば, $\displaystyle P_{n,k,D}=\frac{1}{k}(1-(-D)^{1-n}).$
</div>
<div class="alert proof"><details><summary>証明 (クリックで展開)</summary>
<p class="alert proof title"></p>
式(2), (4)より,
$$
\begin{align*}
P_{n,k,D}
&= \frac{1}{k}\left\{1+D^{-n}\sum_{m=1}^{k-1}\left\{\xi^m(1-\xi^{(k-1)m})(1-\xi^m)^{-1}\right\}^n\right\} \\
&= \frac{1}{k}\left\{1+D^{-n}\sum_{m=1}^{k-1}(-1)^n\right\} \\
&= \frac{1}{k}(1-(-D)^{1-n}). \\
\end{align*}
$$
<div style="position: relative;"><span style="position: absolute; right: 0em; bottom: 0em; font-size: 1.5em;">■</span></div>
</details>
</div>
<hr/>
<h2 id="計算量を削減する"><a class="header" href="#計算量を削減する">計算量を削減する</a></h2>
<p>定理2, 3 の条件に該当しない場合, 簡単に $P_{n,k,D}$ を導出する方法は (おそらく) ないと思う.
ここでは, 少しでも計算量を削減するための工夫を考えよう.</p>
<div class="alert important"><p class="alert important title">補題4</p>
$\theta\in\mathbb{R},\;e^{i\theta}\neq1$ のとき,
$$\sum_{k=1}^{n} e^{ik\theta} = \frac{\sin\frac{n\theta}{2}}{\sin\frac{\theta}{2}}e^{i(n+1)\theta/2}.$$
</div>
<div class="alert proof"><details><summary>証明 (クリックで展開)</summary>
<p class="alert proof title"></p>
<a href="../analysis/sum_sin_cos.html">$\sum_{k=0}^{n}\sin k\theta, \sum_{k=0}^{n}\cos k\theta$</a> のときと同様である.
<div style="position: relative;"><span style="position: absolute; right: 0em; bottom: 0em; font-size: 1.5em;">■</span></div>
</details>
</div>
<p>補題4より,</p>
<p>$$
\begin{align*}
P_{n,k,D}
&= \frac{1}{k}\left\{1+D^{-n}\sum_{m=1}^{k-1}\left(\sum_{j=1}^{D}\xi^{jm}\right)^n\right\} \\
&= \frac{1}{k}\left\{1+D^{-n}\sum_{m=1}^{k-1}\left(\sum_{j=1}^{D}e^{ij\frac{2m\pi}{k}}\right)^n\right\} \\
&= \frac{1}{k}\left\{1+D^{-n}\sum_{m=1}^{k-1}\left(\frac{\sin\frac{Dm\pi}{k}}{\sin\frac{m\pi}{k}}e^{i(D+1)m\pi/k}\right)^n\right\}.
\end{align*}
$$</p>
<p>更に, 虚部は $m=1,k-1$ や $m=2,k-2$ などの 合計が $k$ になる組で打ち消しあうことに注意すれば, 総和記号を削減して三角関数に置き換えることができる.</p>
<div class="alert tip"><p class="alert tip title">定理5</p>
どの目も出る確率が同様に確からしい $D$ 面サイコロを $n$ 個投げたときの出た目の合計が $k$ の倍数である確率を $P_{n,k,D}$ とすれば,
$$
\begin{align*}
P_{n,k,D}
&= \frac{1}{k}\left\{1+D^{-n}\sum_{m=1}^{k-1}\left(\frac{\sin\frac{Dm\pi}{k}} {\sin\frac{m\pi}{k}}\right)^n\cos\frac{(D+1)mn\pi}{k}\right\} \\
&= \begin{cases}
\frac{1}{k}\left\{1+2D^{-n}\sum_{m=1}^{k/2 -1}\left(\frac{\sin\frac{Dm\pi}{k}}{\sin\frac{m\pi}{k}}\right)^n\cos\frac{(D+1)mn\pi}{k} + D^{-n}{\sin^n\frac{D\pi}{2}}\cos\frac{(D+1)n\pi}{2}
\right\}  & \text{if $k$ is even,}\\
\frac{1}{k}\left\{1+2D^{-n}\sum_{m=1}^{(k-1)/2}\left(\frac{\sin\frac{Dm\pi}{k}}{\sin\frac{m\pi}{k}}\right)^n\cos\frac{(D+1)mn\pi}{k} \right\} & \text{if $k$ is odd.}
\end{cases} \\
\end{align*}
$$
</div>
<hr/>
<h2 id="例-d6-のとき"><a class="header" href="#例-d6-のとき">例: $D=6$ のとき</a></h2>
<p>実際に6面サイコロが2から10までの倍数である確率を実際に計算して求めてみよう.</p>
<p>$$
P_{n,k,6}
= \frac{1}{k}\left\{1+2\cdot6^{-n}\sum_{m=1}^{\lceil{k/2}\rceil-1}\left(\frac{\sin\frac{6m\pi}{k}} {\sin\frac{m\pi}{k}}\right)^n\cos\frac{7mn\pi}{k}\right\}.
$$</p>
<p>$k=2,3,6$ のときは定理2, $k=7$ のときは定理3が適用できることにも注意する.</p>
<div class="alert warning"><p class="alert warning title">注意</p>
$(-1)^n=\cos n\pi,\;-\cos(x) = \cos(x+n\pi)$ を使うことで, より式を簡潔にできる場合がある.
</div>
<div class="table-wrapper"><table><thead><tr><th>$k$</th><th>$P_{n,k,6}$</th></tr></thead><tbody>
<tr><td>2</td><td>$\displaystyle\frac{1}{2}$</td></tr>
<tr><td>3</td><td>$\displaystyle\frac{1}{3}$</td></tr>
<tr><td>4</td><td>$\displaystyle\frac{1}{4}\left\{1+2\left(\frac{\sqrt{2}}{6}\right)^n\cos\frac{3n\pi}{4}\right\}$</td></tr>
<tr><td>5</td><td>$\displaystyle\frac{1}{5}\left\{1+2\cdot6^{-n}\left(\cos\frac{2n\pi}{5}+\cos\frac{4n\pi}{5}\right)\right\}$</td></tr>
<tr><td>6</td><td>$\displaystyle\frac{1}{6}$</td></tr>
<tr><td>7</td><td>$\displaystyle\frac{1}{7}\left\{1-(-6)^{1-n}\right\}$</td></tr>
<tr><td>8</td><td>$\displaystyle\frac{1}{8}\left\{1+2\left(\frac{\sqrt{2}}{6}\right)^n\cos\frac{3n\pi}{8}+2\left(\frac{\sqrt{2-\sqrt{2}}}{6}\right)^n\cos\frac{5n\pi}{8}+2\left(\frac{\sqrt{2+\sqrt{2}}}{6}\right)^n\cos\frac{7n\pi}{8}\right\}$</td></tr>
<tr><td>9</td><td>$\displaystyle\frac{1}{9}\left\{1+2\left(\frac{\sqrt{2\cos(\pi/9)-1}}{6}\right)^n\cos\frac{n\pi}{9}+2\left(\frac{\sqrt{3+2\sin(\pi/18)-4\cos(2\pi/9)}}{6}\right)^n\cos\frac{2n\pi}{9}+2\left(\frac{\sqrt{1+2\cos(\pi/18)}}{6}\right)^n\cos\frac{4n\pi}{9}\right\}$</td></tr>
<tr><td>10</td><td>$\displaystyle\frac{1}{10}\left\{1+2\cos\frac{n\pi}{5}+2\cos\frac{2n\pi}{5}+2\left(\frac{\sqrt{5-2\sqrt{5}}}{6}\right)^n\cos\frac{n\pi}{10}+2\left(\frac{\sqrt{5+2\sqrt{5}}}{6}\right)^n\cos\frac{3n\pi}{10}\right\}$</td></tr>
</tbody></table>
</div>
<nav aria-label="Page navigation" class="prev-next-buttons">
<a aria-keyshortcuts="Left" class="local-button active" href="../analysis/sum_sin_cos.html" rel="prev" style="text-decoration: none;" title="$\sum_{k=0}^{n}\sin k\theta, \sum_{k=0}^{n}\cos k\theta$">
<span class="arrow">←</span>
<span class="where">$\sum_{k=0}^{n}\sin k\theta, \sum_{k=0}^{n}\cos k\theta$</span>
</a>
<a aria-keyshortcuts="Right" class="local-button active" href="../test.html" rel="next" style="text-decoration: none;" title="test">
<span class="where">test</span>
<span class="arrow">→</span>
</a>
</nav></main>

</div>
</div>
<nav aria-label="Page navigation" class="nav-wide-wrapper">
<a aria-keyshortcuts="Left" aria-label="Previous chapter" class="nav-chapters previous" href="../analysis/sum_sin_cos.html" rel="prev" title="Previous chapter">
<i class="fa fa-angle-left"></i>
</a>
<a aria-keyshortcuts="Right" aria-label="Next chapter" class="nav-chapters next" href="../test.html" rel="next prefetch" title="Next chapter">
<i class="fa fa-angle-right"></i>
</a>
</nav>
</div>
<script>
            window.playground_copyable = true;
        </script>
<script src="../elasticlunr.min.js"></script>
<script src="../mark.min.js"></script>
<script src="../searcher.js"></script>
<script src="../clipboard.min.js"></script>
<script src="../highlight.js"></script>
<script src="../book.js"></script>
<!-- Custom JS scripts -->
</div>
</body>
</html>
